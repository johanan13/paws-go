<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Paws2Go - Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/login.css">
</head>
<body>

<div class="row g-0 h-100">

  <!-- Left Side (Visual Section) -->
  <aside class="col-md-6 split-left d-none d-md-block position-relative" aria-label="Visual welcome section">
    <div class="logo-wrapper position-absolute top-0 start-0 p-4">
      <img src="assets/p2g-logo-colored-copy.png" alt="Paws2Go logo" width="180">
    </div>
    <div class="overlay">
      <h2 class="fw-bold display-6">Vet Care at Your Door,<br>Wherever You Go</h2>
      <p class="mt-3 fs-5">A fast, accessible, and reliable way to get veterinary services without the stress and inconvenience of visiting physical clinicsâ€”especially during emergencies.</p>
    </div>
  </aside>

  <!-- Right Side (Form Section) -->
  <main class="col-md-6 d-flex align-items-center justify-content-center bg-white position-relative" role="main">
    <!-- Logo for small screens -->
    <header class="logo-mobile d-md-none position-absolute top-0 start-0 p-4">
      <img src="assets/p2g-logo-colored-copy.png" alt="Paws2Go logo" width="160">
    </header>

    <div class="login-form p-4 mt-5 mt-md-0" aria-labelledby="login-heading">
      <h1 class="fw-bold text-center mb-4" id="login-heading">Hello, welcome!</h1>
      <form id="login-form">
        <div class="mb-3">
          <label for="email" class="form-label">Email</label>
          <input type="email" id="email" name="email" class="form-control" placeholder="Enter your email">
        </div>
        <div class="mb-3">
          <label for="password" class="form-label">Password</label>
          <input type="password" id="password" name="password" class="form-control" placeholder="Enter your password">
        </div>
        <div class="d-grid mb-3">
    <button type="submit" class="btn btn-login">Login</button>
  </div>
        <div class="text-center">
          <small>No account yet? <a href="register.html" class="text-decoration-none">Register here</a></small>
        </div>
      </form>
    </div>
  </main>
</div>
<script>
 const form = document.getElementById('login-form');

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;

  if (!email || !password) {
    alert('Please enter both email and password.');
    return;
  }

  try {
    const response = await fetch('http://localhost:5000/api/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password }),
    });

    const data = await response.json();

    if (response.ok) {
      localStorage.setItem('userId', data.user._id);
      localStorage.setItem('userRole', data.user.role); // save role too

      alert('Login successful! Redirecting...');

      // Redirect based on role
      if (data.user.role === 'admin') {
        window.location.href = 'admin-booking-history.html';
      } else {
        // default to user dashboard
        window.location.href = 'my-pets.html';
      }
    } else {
      alert(data.error || 'Invalid email or password.');
    }
  } catch (error) {
    console.error('Error:', error);
    alert('Server error. Please try again later.');
  }
});

</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
